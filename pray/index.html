
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta name="keywords" content="Masalma Masalma.com" />
    <meta name="description" content="Masalma Masalma.com" />
    <meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />
    <meta name="robots" content="index,follow" />
    <meta property="og:locale" content="en_US" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Home, Masalma.com" />
    <meta property="og:description" content="Masalma Masalma.com" />
    <meta property="og:url" content="https://masalma.com/" />
    <meta property="og:site_name" content="Masalma.com" />
    <link rel="canonical" href="https://masalma.com/" />

    <title>Masalma - Ramadan Countdown</title>
    <link rel="icon" type="image/x-icon" href="favicon.ico">
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-W1R7TB87PT"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    
      gtag('config', 'G-W1R7TB87PT');
    </script>
    
    <!--<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
      integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">-->
    <link rel="stylesheet" type="text/css" href="bootstrap.min.css">

    <!--<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>-->
    <script type="text/javascript" src="bootstrap.bundle.min.js"></script>

    <!--<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>-->
    <script type="text/javascript" src="jquery.min.js"></script>

    <link rel="stylesheet" type="text/css" href="custom.css">

    <script src="adhan.umd.min.js"></script> <!-- from https://github.com/batoulapps/adhan-js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment-with-locales.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment-timezone/0.5.28/moment-timezone-with-data-10-year-range.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.slim.min.js" integrity="sha256-kmHvs0B+OpCW5GVHUNjv9rOmY0IvSIRcf7zGUDTDQM8=" crossorigin="anonymous"></script>

    <style>
      body {
        background-color: black;
        color: white;
        font-family: sans-serif;
        text-align: center;
      }
      #countDown {
        font-size: calc(.5em + 8vw);
        text-align: center;
      }

      .div-table {
        text-align: left;
        border-spacing: 10px 0;
        color: gray;
        display: table;
      }

      .div-table-row {
        display: table-row;
      }

      .div-table-cell {
        display: table-cell;
      }



    </style>


  </head>



  <body>
    <script type="text/javascript">

      var dLatitude = 43.4590806;
      var dLongitude = -80.5355996;



      function prayerName(prayer) {
        if (prayer == adhan.Prayer.Fajr) {
          return "Fajr";
        } else if (prayer == adhan.Prayer.Sunrise) {
          return "Sunrise";
        } else if (prayer == adhan.Prayer.Dhuhr) {
          return "Dhuhr";
        } else if (prayer == adhan.Prayer.Asr) {
          return "Asr";
        } else if (prayer == adhan.Prayer.Maghrib) {
          return "Maghrib";
        } else if (prayer == adhan.Prayer.Isha) {
          return "Isha";
        } else if (prayer == adhan.Prayer.None) {
          return "None";
        }
      }


      function gregorianToHijri(gy, gm, gd) {
        // ToDo:...
        //use fordetecting ramadan, else show normal prayer time and next pryer countdown
      }



      function useLocation(lat, long) {

        const coordinates = new adhan.Coordinates(lat, long);
        const params = adhan.CalculationMethod.NorthAmerica();
        const date = new Date();

        var prayerTimes = new adhan.PrayerTimes(coordinates, date, params);

        var sunnahTimes = new adhan.SunnahTimes(prayerTimes);


        var star = ["", "", "", "", ""]
        var aStar = "> ";
        //var cp = prayerName(prayerTimes.currentPrayer());
        var np = prayerName(prayerTimes.nextPrayer());

        //console.log(np);
        switch (np) {
          case "Fajr":
            star[0] = aStar;
            break;
          case "Sunrise":
          case "Dhuhr":
            star[1] = aStar;
            break;
          case "Asr":
            star[2] = aStar;
            break;
          case "Maghrib":
            star[3] = aStar;
            break;
          case "Isha":
            star[4] = aStar;
            break;
        }

        $("#PTDate").html(moment(date).format('MMMM DD, YYYY'));
        //$("#fajr").html(star[0] + moment(prayerTimes.fajr).tz('America/New_York').format('h:mm A'));
        $("#fajr").html(star[0] + moment(prayerTimes.fajr).format('h:mm A'));
        $("#sunrise").html(moment(prayerTimes.sunrise).format('h:mm A'));
        $("#dhuhr").html(star[1] + moment(prayerTimes.dhuhr).format('h:mm A'));
        $("#asr").html(star[2] + moment(prayerTimes.asr).format('h:mm A'));
        $("#maghrib").html(star[3] + moment(prayerTimes.maghrib).format('h:mm A'));
        $("#isha").html(star[4] + moment(prayerTimes.isha).format('h:mm A'));
        //$("#midnight").html(moment(sunnahTimes.middleOfTheNight).format('MMMM DD, h:mm A'));
        //$("#lastthird").html(moment(sunnahTimes.lastThirdOfTheNight).format('MMMM DD, h:mm A'));
        $("#qibla").html(Math.round(adhan.Qibla(coordinates) * 100) / 100 + "&deg;");
        $("#latLong").html(lat +  ", " + long);


        if ($.inArray(prayerTimes.currentPrayer(), ['isha']) > 0 ) {
          var countDownDate = moment(prayerTimes.fajr);
          var nextP = "Fajr";

        } else {
          var countDownDate = moment(prayerTimes.maghrib);
          var nextP = "Magrib";
        }

        var x = setInterval(function() {
          var now = new Date().getTime();
          var distance = countDownDate - now;

          var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
          var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
          var seconds = Math.floor((distance % (1000 * 60)) / 1000);
        
          document.getElementById("countDown").innerHTML = "Time until " + nextP + "<br />" + hours + "h "
          + minutes + "m " + seconds + "s ";

          if (distance < 0) {
            clearInterval(x);
            $('body').css('background-color', 'red');
            document.getElementById("countDown").innerHTML = "Done...";
          }
        }, 1000);




      }
      
      function getLocation() {
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(
            (position) => {
              const latitude = position.coords.latitude;
              const longitude = position.coords.longitude;
              useLocation(latitude, longitude);
            },
            (error) => {
              console.error("Error getting location:", error.message);
              useLocation(dLatitude, dLongitude);
            }
          );
        } else {
          console.warn("Geolocation is not supported by this browser.");
          useLocation(dLatitude, dLongitude);
        }
      }
      
      getLocation();



    </script>
    <div>
      <p id="countDown">Countdown<br />Timer</p>
    </div>


    <div class="div-table">
      <div class="div-table-row">
        <div class="div-table-cell">Prayer times for</div>
        <div class="div-table-cell" id=PTDate>date</div>
      </div>

      <div class="div-table-row">
        <div class="div-table-cell"><br /></div>
      </div>

      <div class="div-table-row">
        <div class="div-table-cell">Fajr</div>
        <div class="div-table-cell" id=fajr>fajr time</div>
      </div>
      <div class="div-table-row">
        <div class="div-table-cell">Sunrise</div>
        <div class="div-table-cell" id=sunrise>sunrise time</div>
      </div>
      <div class="div-table-row">
        <div class="div-table-cell">Dhuhr</div>
        <div class="div-table-cell" id=dhuhr>dhuhr time</div>
      </div>
      <div class="div-table-row">
        <div class="div-table-cell">Asr</div>
        <div class="div-table-cell" id=asr>asr time</div>
      </div>
      <div class="div-table-row">
        <div class="div-table-cell">Maghrib</div>
        <div class="div-table-cell" id=maghrib>maghrib time</div>
      </div>
      <div class="div-table-row">
        <div class="div-table-cell">Isha</div>
        <div class="div-table-cell" id=isha>isha time</div>
      </div>

      <div class="div-table-row">
        <div class="div-table-cell"><br /></div>
      </div>
<!--
      <div class="div-table-row">
        <div class="div-table-cell">middle of the night</div>
        <div class="div-table-cell" id=midnight>midnight time</div>
      </div>
      <div class="div-table-row">
        <div class="div-table-cell">last third of the night</div>
        <div class="div-table-cell" id=lastthird>last third of the night time</div>
      </div>
-->
      <div class="div-table-row">
        <div class="div-table-cell">Qibla Direction</div>
        <div class="div-table-cell" id=qibla>qibla direction</div>
      </div>
      <div class="div-table-row">
        <div class="div-table-cell">Lat/Long</div>
        <div class="div-table-cell" id=latLong>lat/long</div>
      </div>
      
    </div>
  </body>
</html>







